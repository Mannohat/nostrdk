---
import { getCollection } from 'astro:content';
import NostrLayout from '../../layouts/NostrLayout.astro';
import FormattedDate from '../../components/FormattedDate.astro';

const posts = (await getCollection('blog')).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);
---

<NostrLayout title="Blog | Nostr.dk" description="Artikler og indlæg om Nostr-protokollen på dansk.">
	<div class="page-header">
		<h1>Blog</h1>
		<p>Artikler og indlæg om Nostr på dansk.</p>
	</div>

	{posts.length === 0 ? (
		<div class="empty">
			<p>Ingen indlæg endnu. Kom snart tilbage!</p>
		</div>
	) : (
		<ul class="post-list">
			{posts.map((post) => (
				<li>
					<a href={`/blog/${post.id}/`}>
						<h2>{post.data.title}</h2>
						<p class="date"><FormattedDate date={post.data.pubDate} /></p>
						<p>{post.data.description}</p>
					</a>
				</li>
			))}
		</ul>
	)}

	<style>
		.page-header {
			text-align: center;
			margin-bottom: 60px;
		}
		.empty {
			text-align: center;
			padding: 80px 20px;
			color: rgba(255,255,255,0.5);
			font-size: 1.2rem;
		}
		.post-list {
			list-style: none;
			padding: 0;
			max-width: 800px;
			margin: 0 auto;
		}
		.post-list li {
			margin-bottom: 40px;
			border-bottom: 1px solid rgba(160,132,202,0.2);
			padding-bottom: 40px;
		}
		.post-list a {
			text-decoration: none;
			color: inherit;
		}
		.post-list h2 {
			font-size: 1.8rem;
			color: #a084ca;
			margin-bottom: 8px;
		}
		.post-list a:hover h2 {
			text-decoration: underline;
		}
		.date {
			color: rgba(255,255,255,0.5);
			font-size: 0.9rem;
			margin-bottom: 10px;
		}
	</style>
</NostrLayout>